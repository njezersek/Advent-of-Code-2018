<script type="input/text" id="input">     /----------------------------------------------------------------------------------------------\
     |                                                          /-----------------------------------+-------------------------------\
     |      /-------------\                             /-------+-----------------------------------+----------------\              |
     |      |        /----+-----------------------------+-------+----------------------------------<+\               |              |
     |      |        |    | /-----------------------\   |       |   /-------------------------------++---------------+\             |
     |      |        |    | |                       |   |      /+---+-----------------\          /--++---------------++\            |
     |      |        |    | |                       |   |      ||/--+-----------------+----------+\ ||               |||            |
     |      |      /-+----+-+-----------------------+---+-----\|||  |                 |          || ||          /----+++------------+------------\
     |      |      | |    | |                       |   | /---++++--+---------------\ |          || ||          |    |||            |            |
     |     /+------+-+----+-+---------------\       |   |/+---++++--+---------------+-+----------++-++----------+---\|||           /+------------+--\
     |     ||      | |    | |  /------------+-------+---+++---++++--+---------------+-+----------++-++----------+---++++-------\/--++------\     |  |
     |     ||      | |    | |  |            |       |   |||   ||||  |               | |          || ||          |   ||||       ||  ||      |     |  |
     \-----++------+-+----+-+--+------------+-------+---+++---++++--+---------------+-+----------++-/|          |   ||||       ||  ||      |     |  |
           ||   /--+-+----+-+--+---------\  |       |/--+++---++++--+---------------+-+----------++--+----------+---++++-------++--++------+-----+-\|
           ||   |  | |    | |  |     /---+--+---\   ||/-+++---++++--+---------------+-+--------\ ||  |          |   ||||       ||  ||      |     | ||
           ||  /+--+-+---\| |  |     |   |  |   |/--+++-+++---++++--+---------------+-+--------+-++--+---->-----+---++++-------++--++------+-\   | ||
           ||  ||  | |   || |/-+-----+---+--+---++--+++-+++---++++--+---------\     | |        | ||/-+----------+---++++-------++--++------+-+---+\||
           ||  ||  | |   || || |     | /-+--+---++--+++-+++---++++--+---------+-----+-+--------+-+++-+----------+---++++-------++--++-----\| |   ||||
           ||  ||  | |   || || |   /-+-+-+--+---++--+++-+++---++++--+---------+-----+-+----\   | \++-+----------+---+++/       ||  \+-----++-+---+++/
  /--------++--++--+-+---++-++-+---+-+-+-+--+---++--+++-+++---++++--+-\       |     | |    |   |  || |          |   |||        ||   |     || |   |||
  |        ||  ||  | |   || || |/--+-+-+-+--+---++--+++-+++---++++--+-+-------+-----+-+----+---+\ || |          |   |||        ||   |     v| |   |||
  |        ||  ||  | |   || || ||  | | | |  |   ||  ||| |||   ||||  | |       |     | |    |   || || |          |   |||        ||   |     || |   |||
  |        ||  ||  | |   || || ||  | | | |  |   ||  ||| |\+---++++--+-+-------+-----+-+----+---++-++-+----------+---/||        ||   |     || |   |||
  |     /--++--++--+-+---++-++-++--+-+-+-+--+---++--+++-+-+---++++--+\|       |     | |    |   || || |          |    ||        ||  /+-----++-+\  |||
  |     |  ||  ||  | |   || || \+--+-+-+-+--+---++--+++-+-+---++++--+++-------+-----+-+----+---++-++-+----------+----++--------/|  ||     || ||  |||
  |     |  ||  ||  | |/--++-++--+--+-+-+-+\ |   ||  |\+-+-+---++++--+++-------+-----+-+----+---++-++-+----------+----++---------+--++-----++-++--++/
  |     |  ||  ||  | ||  || ||  |  | | | || |   ||  | | | |   ||\+--+++-------+-----+-+----+---++-++-+----------+----++---------+--+/     || ||  ||
  |     |  ||  \+--+-++--/| ||  |  | | | || |   ||  | | | \---++-+--+++-------+-----/ |    |   || || |          |    ||         |  |      || ||  ||
  |     |  ||/--+--+>++---+-++--+--+-+-+-++-+---++--+-+-+-----++-+--+++-------+-------+-\  |   || || |/---------+----++-----\   |  |  /---++-++-\||
  | /---+--+++--+--+-++---+-++--+--+-+-+-++-+-\ ||  | | |     || |  |||       |       | |  |   || || ||         |    ||     |   |  |  |   || || |||
  | |   |  |||  |  | ||   | ||  |  | | | || | | ||  | | | /---++-+--+++-------+-------+-+--+---++-++-++---------+----++-----+---+--+--+---++-++-+++-\
/-+-+---+--+++--+--+-++---+-++--+--+-+-+-++-+-+-++--+-+-+-+---++-+--+++-------+-------+-+\ |   || || ||         |    ||     |   |  |  |   || || ||| |
| | |   |/-+++--+--+-++---+-++--+--+-+-+-++-+-+-++--+-+-+-+---++-+--+++-------+-------+-++-+---++\|| ||         |/---++-----+---+-\|  |   || || ||| |
| | |   || |||  |  | ||   | ||  |/-+-+-+-++-+-+-++--+-+-+\|   || |  |||   /---+-------+-++-+---+++++-++---------++---++-----+---+-++--+---++\|| ||| |
| | |   || |||/-+--+-++---+-++--++-+-+-+-++-+-+-++\ | \-+++---++-+--+++---+---+-------+-++-+---/|||| ||         ||   ||   /-+---+-++--+---+++++-+++-+\
| | |   || |||| |  | ||   | ||  || | | | || | | ||| |   |||   || |  |||   |   |       | || |    |||| ||         ||   ||   | |   | ||  |   ||||| ||| ||
| | |   || |||| |  | ||   | ||/-++-+-+-+-++-+-+-+++-+---+++---++-+--+++---+---+-------+-++-+----++++-++---------++---++---+-+\  | || /+---+++++-+++\||
|/+-+---++-++++-+--+-++---+-+++-++-+-+-+-++-+-+-+++-+---+++---++-+--+++---+---+-------+-++-+----++++-++-----\   ||   ||   | ||  | || ||   ||||| ||||||
||| |   || \+++-+--+-++---+-+++-++-+-+-+-++-/ | ||| |   |||/--++-+--+++---+---+-------+-++-+----++++-++-----+---++---++---+-++-\| || ||   ||||| ||||||
||| |   ||  ||| |  | ||   | ||| ||/+-+-+-++---+-+++-+---++++--++-+\ |||   |   |       | || |/---++++-++-----+---++---++---+-++-++-++-++---+++++\||||||
||| |   ||  ||| |  | ||   | ||| |||| | |/++---+-+++-+---++++--++-++-+++---+---+-------+-++-++---++++-++-----+-\ ||   ||   | || || || ||   ||||||||||||
||| |   ||  ||| |  | ||   | ||| |||| \-++++---+-/|| |   ||||  || || |||   |   |       | || ||   |||| ||     | | ||   ||   | || || || ||   ||||||||||||
||| |/--++--+++-+--+-++---+\||| ||||   ||||   |  || |   ||||  || || |||   |   |       | || ||   |||| ||     | | ||   ||   | || || || ||   ||||||||||||
||| || /++--+++-+--+-++---+++++-++++---++++---+--++-+---++++--++-++-+++\  |   |       | || ||   |||| ||     | | ||   ||   | || || || ||   ||||||||||||
||| || |||  ||| |  | ||   ||||| |\++---++++---+--++-+---+/||  |\-++-++++--+---+-------/ || ||   |||| ||     | | ||   ||   | || || || ||   ||||||||||||
||| || |||  ||| |  | ||   ||||| | ||   ||||   |  || |   | ||  |  || ||||  | /-+---------++-++---++++-++-----+-+-++---++---+-++\|| || ||   ||||||||||||
||| || |||  ||| |  | ||   ||||| \-++---++++---+--++-+---+-++--+--++-++++--+-+-+---------++-++---/||| ||     | | ||   ||   | ||||| || ||   ||||||||||||
||| || ||v  ||| \--+-++---+++++---++---++/| /-+--++-+---+-++--+--++-++++--+-+-+---------++-++----+++-++-\   | | ||   ||   | ||||| || ||   ||||||||||||
||| || |||  |||    | ||   |||||   ||   || | |/+--++-+---+-++--+--++-++++--+-+-+---------++-++----+++-++-+---+-+-++---++---+-+++++-++-++--\||||||||||||
||| || |||  |||    | ||   |||||   ||   || | |||  || |   |/++--+--++-++++--+-+-+--\      || ||    ||| || |   | | ||   ||   | |^||| || ||  |||||||||||||
||| || |||  |\+----+-++---+++++---++---++-+-+++--++-+---++++--+--++-++++--+-+-+--+------/| ||    ||| || |   | | ||   ||   | ||||| || ||  |||||||||||||
|||/++-+++--+-+----+-++---+++++---++---++-+-+++--++-+---++++--+--++-++++--+-+-+--+-------+\||    ||| || |   | | ||   ||   \-+++++-++-++--++++++++++++/
|||||| |||  | |    | ||   |||||   \+---++-+-+++--++-+---++++--+--+/ ||||  | | |  |       ||||    ||| || |   | | ||   ||     ||||| || ||  ||||||||||||
|||||| |||  | |    | ||   |||||   /+---++-+-+++--++-+---++++--+--+--++++--+-+-+--+-------++++--\ ||| |\-+---+-+-++---++-----/|||| || ||  ||||||||||||
|||||| |||  | |    | ||   |||||   ||   || | |||  || |   ||||  |  |  ||||  | | |  |       ||||  | ||| |  |   | | ||   ||      |||| || ||  ||||||||||||
|||||| ||| /+-+----+-++---+++++---++---++-+-+++--++-+---++++--+--+--++++--+-+-+\ |       ||||  | ||| |  |   | | ||   ||      |||| || ||  ||||||||||||
|||||| ||| || |    | || /-+++++---++---++-+-+++--++-+---++++--+--+--++++--+-+-++-+-------++++--+-+++-+--+---+-+-++---++--\   |||| || ||  ||||||||||||
|||||| ||| || |    | || | |||||   || /-++-+-+++--++-+---++++--+--+-\||||  | | || |       ||||  | ||| |  |   | | ||   ||  |   |||| || ||  ||||||||||||
|||||| ||| || |    | || | |||||/--++-+-++-+-+++--++-+---++++--+--+-+++++--+-+-++-+\      ||||  | ||| |  |   | | ||   ||  |   |||| || ||  ||||||||||||
|||||| ||| ||/+----+-++-+-++++++--++-+-++-+-+++-\|| |   |||\--+--+-+++++--+-+-++-++------++++--+-+++-+--+---+-+-++---++--+---++/| || ||  ||||||||||||
|||||| ||| ||||    | || |/++++++--++-+-++-+-+++-+++-+---+++---+--+-+++++--+-+-++-++------++++--+-+++-+--+---+-+\||   ||  |   || | || ||  ||||||||||||
|||||| ||| |\++----+-++-++/|||||  || | || | \++-+++-+---+++---+--+-+++++--+-+-++-++------++++--+-+++-+--/   | ||||   ||  |   || | || ||  ||||||||||||
|||||| ||| | ||/---+-++-++-+++++--++\| || |  || ||| |   |||   |  | |||||  | | || ||      ||||  | ||| |  /---+-++++---++--+--\|| | || ||  ||||||||||||
|||||| ||| | |\+---+-++-++-+++++--++++-++-+--++-++/ |   |||   |  | |||||  | | || ||      ||||  | ||| |  |   | ||\+---++--+--+++-+-++-++--++++++++/|||
|||||| ||| | | |   | || || |||||  |||| || |/-++-++--+---+++---+--+-+++++--+-+-++-++------++++--+-+++-+--+---+-++-+---++--+-\||| | || ||  |||||||| |||
|||||| ||| | | |   | || ||/+++++--++++-++-++-++-++--+---+++---+--+-+++++--+-+-++-++\     ||||  | ||| |  |   | || |   ||  | |||| \-++-++--++/||||| |||
|||||| ||| | | |   | || ||||||||/-++++-++-++-++-++--+---+++---+--+-+++++--+-+-++-+++-----++++--+-+++-+--+---+-++-+---++--+-++++---++-++\ || ||||| |||
|||||| ||| | | |   | || ||||||||| |||| || || || ||  |   |||   |  | |||||  | | || |||     ||||  | ||| |  |   | || |   ||  | ||||   || ||| || ||||| |||
|||||| ||| | | |   | || |||||\+++-++++-++-++-++-++--+---+++---+--+-+++++--+-+-/| |||     ||||  | ||| |  |   | || |   ||  | ||||   || ||| || ||||v |||
||||\+-+++-+-+-+---+-++-+++++-+++-++++-++-++-+/ || /+---+++---+--+-+++++--+-+--+-+++-----++++--+-+++-+--+---+-++-+---++--+-++++--\|| ||| || ||||| |||
|||| | ||| | | |   | || ||||| \++-++++-++-++-+--++-++---+++---+--+-+++++--+-+--+-+++-----++++--+-+++-+--+---+-++-+---++--+-++/|  ||| ||| || ||||| |||
|||| |/+++-+-+-+---+-++-+++++--++-++++\|| || |  || ||   |||   |/-+-+++++--+-+--+-+++-----++++--+-+++-+--+---+-++-+---++--+-++-+--+++-+++-++-+++++\|||
|||| ||||| | | | /-+-++-+++++--++-+++++++-++-+--++-++---+++---++-+-+++++--+-+--+-+++-----++++-\| |||/+--+---+-++-+---++--+\|| |  ||| ||| || |||||||||
|||| ||||| | | | | |/++-+++++--++-+++++++-++-+-\|| || /-+++---++-+-+++++--+-+--+-+++-----++++-++-+++++--+---+-++-+---++--++++-+--+++-+++-++-+++++++++\
|||| ||||| | | | | |||| |||||  || |||||||/++-+-+++-++-+-+++---++-+-+++++--+-+--+-+++-----++++-++-+++++--+---+-++-+---++--++++-+--+++\||| || ||||||||||
|||| ||||| | | | | |||| |||||  || |||||||||| | ||| || | |||   || | |||||  | |  | |||     |||\-++-+++++--+---+-++-+---++--++++-+--+++++++-++-+++/||||||
|||| ||||| | | ^ | |||| |||||  || |||||||||| | ||| || | |||   || | |||||  | |  | |||     |||  || |||||  |   | || |   ||  |||| |  ||||||| || ||| ||||||
|||| ||||| | | | | |||| |||||  || |||||||||\-+-+++-++-+-+++---++-+-+++++--+-+--+-+++-----+++--++-+++++--+---+-++-+---++--++/| |  |||||\+-++-+++-/|||||
|||| ||||| | | | | |||| |||||  || |||||||||  | ||| || | |||   || | |||||  | |  | |||     |||  || |||||  |   | || |   ||  || | |  ||||| | || |||  |||||
|||| ||||| | | | | ||\+-+++++--++-+++++++++--+-+++-++-+-+++---++-+-+++++--+-+--+-+++-----+++--++-++++/  |   | || |   ||  || | |  ||||| | || |||  |||||
|||| ||||| | | | | || | ||\++--++-+++++++++--+-+++-++-+-+++---++-+-+++++--+-+--+-++/     |||  || ||||   |   | || |   ||  || | |  ||||| | || |||  |||||
|||| ||||| | | | | || | || ||  || |||||||||  | ||| || | |||   || | |||||  |/+--+-++------+++--++-++++---+-\ | || |   ||  || | |  ||||| | || |||  |||||
|||| ||||| | | | | || | |\-++--++-+++++++++--+-+++-++-+-+++---++-+-+++++--+++--+-++------+++--++-++++---+-+-+-+/ |   ||  || | | /+++++-+-++\|||  |||||
|||| ||||| | | | | || | |  ||  || |||||||||  | ||| || | |||   |\-+-+++++--+++--+-++------+++--++-++++---+-+-+-+--+---++--++-+-+-++++++-+-++++++--/||||
|||| ||||| | | | | \+-+-+--++--++-+++++++++--+-+++-++-+-+++---/  | |||||  |||  | ||      |||  || ||||   | | | |  |   ||  || | | |||||| |/++++++--\||||
|||| |\+++-+-+-+-+--+-+-+--++--++-++++/||||  | ||| || | |||      | |||||  |||  | ||      |||  || ||||   | | | |  |   ||  || | | |||||| ||||||||  |||||
|||| | ||| | | | |  | | |/-++--++-++++-++++--+-+++-++-+-+++------+-+++++--+++--+-++-\    |||  ||/++++---+-+-+-+--+---++--++-+-+-++++++\||||||||  |||||
||||/+-+++-+-+-+-+--+-+-++-++--++-++++-++++--+-+++-++-+-+++------+-+++++--+++--+-++-+----+++--+++++++---+-+-+-+-\|   ||  v| | | |||||||||||||||  |||||
|||||| ||| | | | |  | | || ||  || |||| ||||  | ||| || | |||      | |||||  |||  | || |    |||  |||||||   | | | | ||   ||  || | | |||||||||||||||  |||||
|||||| ||| | | | |  | | || ||  \+-++++-++++--+-+++-++-+-+++------+-+++++--+++--+-+/ |    |||  |||||||   | | | | ||   ||  || | | |||||||||||||||  |||||
|||||| ||| | | | |  | | || ||  /+-++++-++++-\| ||| || |/+++------+-+++++--+++--+-+--+----+++--+++++++---+-+-+-+-++---++\ || | | |||||||||||||||  |||||
|||||| ||| | | | |  | | || ||  || |||| |||| || ||| || |||\+------+-+++++--+++--+-/  |    |||  |||||||   | | | | ||   ||| || | | ||||^||||||||||  |||||
|||||| ||| | | | |  | | || ||  || \+++-++++-++-+++-++-+++-+------+-+++++--+++--+----+----+++--+/|||||   | | | | ||   ||| || | | |||||||||||||||  |||||
|||||| ||| | | | |  | | || ||  ||  ||| |||| || ||| || ||| |      | |||||  |||  |    |    |||  | |||||   | | | | ||   ||| || | | |||||||||||||||  |||||
|||||| |\+>+-+-+-+--+-+-++<++--++--+++-++++-++-+++-++-+++-+------+-++/||  |||  |    |    |||  | |||||   | | | | ||   ||| || | | |||||||||||||||  |||||
||||||/+-+-+-+-+-+--+-+-++-++--++--+++-++++-++-+++-++-+++-+------+-++-++--+++--+----+----+++--+-+++++---+-+-+-+\||   ||| || | | |||||||||||||||  |||||
|||||||| | | | | |  | | \+-++--++--+++-++++-++-+++-++-+++-+------+-++-++--+++--+----+----+++--+-+++++---+-+-+-++++---+++-/| | | |||||||||||||||  |||||
|||||||| | | | | \--+-+--+-++--++--+++-++++-++-+++-++-+++-+------+-++-++--+++--+----+----+++--/ |||||   | | | ||||   |||  | | | \++++++++++/|||  |||||
|||||||| | | | |    | |  | ||  ||  ||| |||| || ||| || ||| |      | || ||  |||  |    |    |||    |||||   | | | ||||   |||  | | |  |||||||||| |||  |||||
|||||||| | | | |   /+-+--+-++--++--+++-++++-++-+++-++-+++-+------+-++-++--+++--+----+----+++----+++++--\| | | ||||   |||  | | |  |||||||||| |||  |||||
|||||||| | | | |   || |  | ||  ||  ||| |||| || ||| ||/+++-+------+-++-++--+++--+----+\   |||    |||||  || | | ||||   |||  | | |  |||||||||| |||  |||||
|||||||| | | | |   || |  | ||  ||  ||| |||| || ||| |||||| |      | || ||  |||  |    ||   |||    |||||  || | | ||||   |||  | | |  |||||||||| |||  |||||
|||||||| | | | |   || |  | ||  ||  ||| |||| || ||| |||||| |      | |\-++--+++--+----++---+++----+++++--++-+-+-++++---+/|  | | |  |||||||||| |||  |||||
|||||||| | | | |   || |  | ||  ||  ||| |||| || ||| |||||| |      | |  ||  |||  |    ||   |||    |||||  || | | ||||   | |  | | |  |||||||\++-+++--/||||
|||||||| | | | |   || |  | ||  ||  ||| |||| || ||| |||||\-+------+-+--++--+++--+----++---+++----+++++--++-+-+-++++---/ |  | | |  ||\++++-++-++/   ||||
|||||||| | | | |   || |  | ||  ||  ||| |||| |\-+++-+++++--+------+-+--++--+++--+----++---+++----+++++--++-+-+-++++-----+--+-+-+--++-++++-/| ||    ||||
||||\+++-+-+-+-+---++-+--+-++--++--+++-++++-+--+++-+++++--+------+-+--++--+++--+----++---+++----+++++--++-+-+-++/|     |  | | |  || ||||  | ||    ||||
|||| ||| | | | |   || \--+-++--++-<+++-+++/ |  ||| |||||  |      | |  ||  ||\--+----++---+++----+++++--++-+-+-++-+-----+--+-+-/  || ||||  | ||    ||||
|||| ||| | | | |   ||    |/++--++--+++\|||  |  ||\-+++++--+------+-+--++--++---+----++---+++----+++++--++-+-+-++-+-----+--+-+----++-++++--+-+/    ||||
|||| ||| | | | |   ||    |||\--++--+++++++--+--++--+/|||  \------+-+--++--++---+----++---+++----+++++--++-+-+-++-+-----+--+-+----++-++++--+-+-----++/|
|||| ||| | | | |   ||    |||   ||  |||||\+--+--++--+-+++---------+-+--++--++---+----++---+++----+++++--++-+-+-/| |     |  | |    || ||||  | |     || |
|||| \++-+-+-+-+---++----++/   ||  ||||| |  |  ||  | |||         | |  ||  ||   |    ||   |||  /-+++++--++-+-+--+-+-----+--+-+----++-++++-\| |     || |
||||  || | | | |   ||    ||    ||  ||||| |  |  ||  | |||         \-+--++--++---+----++---+++--+-++/||  || | |/-+-+-----+--+-+--\ || |||| || |     || |
||||  || | | | |   ||    ||    ||  ||||| |  |  ||  | \++-----------+--++--++---+----+/   |||  | || \+--++-+-++-+-+-----+--+-+--+-++-++++-++-+-----/| |
||||  || \-+-+-+---++----++----++--+++++-+--+--++--+--++-----------+--++--++---+--->+----+++--+-+/  |  || | || | |     |  | |  | || |||| || |      | |
||||  ||   | | |   ||    ||    ||  ||||\-+--+--++--+--++-----------+--++--++---+----+----+++--+-+---+--++-+-++-+-+-----+--+-+--+-++-++++-+/ |      | |
||||  |\---+-+-+---++----++----++--++++--+--+--++--+--++-----------+--+/  ||   |    |    |||  | |   |  || | || | |     |  | |  | || |||| |  |      | |
||||  |    | | |   \+----++----++--++++--+--+--++--+--++-----------+--+---++---+----+----+++--+-+---+--/| | || | |     |  | |  | || |||| |  |      | |
||||  |    | | |    |    ||    ||  ||||  |  |  ||  |  ||           |  |   \+---+<---+----+++--+-+---+---+-+-++-+-+-----+--+-+--+-++-++++-+--/      | |
||||  |    | | | /--+----++----++\ ||||  |  |  ||  |  ||           |  |    |   |    |    |||  | |   |   | | || | |     |  | |  | || |||| |         | |
||||  |    | | | |  |    ||    |\+-++++--+--+--++--+--++-----------+--+----+---+----+----+++--+-+---+---+-+-++-+-+-----+--+-+--+-++-+++/ |         | |
|\++--+----+-+-+-+--+----++----+-+-++++--+--+--++--+--++-----------+--+----+---+----+----+++--+-+---+---+-+-/| | |     |  | |  | || |||  |         | |
| \+--+----+-+-+-+--+----++----+-+-++++--+--+--++--+--++-----------+--/    |   |    |    |||  | |   |   | |  | | |     |  | v  | || |||  |         | |
|  |  |    | | | |  |    ||    | | \+++--+--+--++--+--++-----------+-------+---+----+----++/  | |   |/--+-+--+-+-+---\ |  | |  | || |||  |         | |
|  |  |    | | | |  |    ||    | |  |||  |  |  ||  |  |\-----------+-------+---+----+----++---+-+---++--+-+--+-+-+---+-/  | |  | || |||  |         | |
|  |  |    | | | |  |    ||    | |  |||  |  |  ||  |  |            | /-----+---+----+----++-\ | |   ||  \-+--+-+-+---+----+-/  | || |||  |         | |
|  |  |    | | | |  |    ||    | |  |||  |  |  ||  |  |            | |    /+---+----+----++-+-+-+---++----+--+-+-+---+----+----+\|| |||  |         | |
|  |  |    | | | |  |    || /--+-+--+++--+--+--++--+--+\           | |    ||   |   /+----++-+-+-+-\ ||    |  | | |   |    |    |||| |||  |         | |
|  |  |    | | | |  |    || |  | |  |||  |  |  ||  |  \+-----------+-+----++---+---++----++-+-+-+-+-++----+--+-+-+---+----+----++++-+++--+---------+-/
|  |  |    | | | |  |    || |  | |  |||  |  |  ||  |   |           | |    ||   |   ||    ||/+-+-+-+-++----+--+-+-+---+----+----++++-+++--+--------\|
\--+--+----+-+-+-+--+----++-+--+-+--+++--+--+--++--+---+-----------+-+----++---+---++----/||| | | | ||    |  | | \---+----+----+++/ |||  |        ||
   |  |    | | | \--+----++-+--+-/  |||  \--+--++--+---+-----------+-+----++---+---++-----+++-+-+-+-++----+--+-+-----+----+----+++--/||  |        ||
   |  |    | | |    |    || |  |    |||     |  ||  |   |           | |    ||   |   ||     ||| | | | ||    |  \-+-----+----+----/||   ||  |        ||
   |  |    | | \----+----++-+--+----/||     |  ||  \---+-----------+-+----++---+---++-----+++-+-+-+-++----+----+-----+----+>----+/   ||  |        ||
   \--+----+-+------+----++-+--+-----++-----+--++------+-----------+-+----++---+---++-----/|| | | | ||    |    |     |    |     |    ||  |        ||
      |    | |      |    || |  |     ||     |  ||      |           | |    ||   |   ||      || | | | ||    |    |     |    |     |    ||  |        ||
      |    \-+------+----++-+--+-----++-----+--++------+-----------+-+----++---/   \+------++-+-+-/ \+----+----+-----+----/     |    ||  |        ||
      |      |      |    || |  |     ||     |  ||      |           | |    ||        |      || | |    |    |    |     |          |    ||  |        ||
      |      |      |    || |  |     ||     |  ||      |           | |    ||        |      || | \----+----+----+-----+----------+----+/  |        ||
      |      |      |    || |  |     ||     |  ||      |      /----+-+--\ ||        |      || |      |    |    |     |          |    |   |        ||
      |      |      |    || |  \-----++-----/  ||      |      |    | |  | ||        |      \+-+------+----+----+-----+----------+----+---+--------/|
      |      |      |    || |        ||        ||      |      |    | |  | ||        |       | |      \----+----+-----/          |    |   |         |
      |      |      |    |\-+--------+/        ||      |      |    | \--+-++--------+-------/ |           |    |                |    |   |         |
      |      |      |    |  \--------+---------++------/      |    |    | \+--------+---------+-----------+----+----------------/    |   |         |
      |      |      |    |           |         ||             |    |    |  |        |         |           |    |                     \---+---------/
      |      |      |    \-----------+---------++-------------+----+----+--+--------/         \-----------+----+-------------------------/
      |      \------+----------------+---------+/             |    |    |  \------------------------------/    |
      |             |                \---------+--------------+----/    |                                      |
      \-------------+--------------------------+--------------+---------+--------------------------------------/
                    \--------------------------/              \---------/                                                                             </script>

<script type="text/input" id="example">/->-\
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/   </script>
<script type="text/input" id="example2">/--\
| /+\
^ \+/
\--/
</script>
<script>
	let input = document.getElementById("input").innerHTML.split("\n");
	let carts = [];
  let w = 0;
  let h = input.length;

	for(let i=0; i<input.length; i++){
    if(w < input[i].length)w = input[i].length;
	}

  for(let i=0; i<h; i++){
    if(carts[i] == undefined)carts[i] = [];
    for(let j=0; j<w; j++){
      let cart = {direction: 0, state: 3};
      if(input[i][j] == "^")cart.direction = 0;
      else if(input[i][j] == ">")cart.direction = 1;
      else if(input[i][j] == "v")cart.direction = 2;
      else if(input[i][j] == "<")cart.direction = 3;
      else cart = undefined;

      carts[i][j] = cart;
    }
  }

	function update(){
    let new_carts = [];
    for(let i=0; i<h; i++){
      if(new_carts[i] == undefined)new_carts[i] = [];
      for(let j=0; j<w; j++){
        new_carts[i][j] = carts[i][j];
      }
    }

    for(let i=0; i<h; i++){
      for(let j=0; j<w; j++){
				if(carts[i][j] != undefined){ // cart found
					//console.log(i,j, input[i][j]);
					if(input[i][j] == "+"){ // intersection
						if(carts[i][j].state == 0 || carts[i][j].state == 2){

						}
						else if(carts[i][j].state == 1){
							carts[i][j].direction++;
							carts[i][j].direction%=4;
						}
						else if(carts[i][j].state == 3){
							carts[i][j].direction += 3;
							carts[i][j].direction%=4;
						}

						carts[i][j].state++;
						carts[i][j].state %= 4;
					}
					if(input[i][j] == "\\"){
						if(carts[i][j].direction == 0)carts[i][j].direction = 3; // ^ -> <
						else if(carts[i][j].direction == 1)carts[i][j].direction = 2; // > -> v
						else if(carts[i][j].direction == 2)carts[i][j].direction = 1; // v -> >
						else if(carts[i][j].direction == 3)carts[i][j].direction = 0; // < -> ^
					}
					if(input[i][j] == "/"){
						if(carts[i][j].direction == 0)carts[i][j].direction = 1; // ^ -> >
						else if(carts[i][j].direction == 1)carts[i][j].direction = 0; // > -> ^
						else if(carts[i][j].direction == 2)carts[i][j].direction = 3; // v -> <
						else if(carts[i][j].direction == 3)carts[i][j].direction = 2; // < -> v
					}

					let ii = i;
					let jj = j;
					if(carts[i][j].direction == 0)ii--;
					if(carts[i][j].direction == 1)jj++;
					if(carts[i][j].direction == 2)ii++;
					if(carts[i][j].direction == 3)jj--;

          //console.log(j,i, "->", jj,ii)

					if(new_carts[ii][jj] != undefined)return {x: jj, y: ii};
					new_carts[ii][jj] = new_carts[i][j];
          new_carts[i][j] = undefined;
				}
			}
		}
    carts = new_carts;
		return false;
	}

	function display(){
		let out = "";
		for(let i=0; i<input.length; i++){
			let row = "";
			for(let j=0; j<input[i].length; j++){
				let c = " ";
				if(input[i][j] == "+")c = "+";
				if(input[i][j] == "|")c = "|";
				if(input[i][j] == "-")c = "-";
				if(input[i][j] == "/")c = "/";
				if(input[i][j] == "\\")c = "\\";
				if(carts[i][j] != undefined){
					if(carts[i][j].direction == 0)c = "⬆️";
					if(carts[i][j].direction == 1)c = "➡️";
					if(carts[i][j].direction == 2)c = "⬇️";
					if(carts[i][j].direction == 3)c = "⬅️";
				}

				row += c;
			}
			out += row + "\n";
		}

		console.log(out);
	}

	let r;
	//while(!r){
		//r = update();
	//}
	console.log(r);
</script>
